{{ template "htmlbegin" . }}
{{ template "dashboardbegin" . }}

  <div class="ui segments">

    <div class="ui segment">

    <form class="ui form" action="{{ .clientUrl }}" method="post">
      {{ .csrfField }}

      <div class="ui teal ribbon label">
        <i class="dragon icon"></i> Create
      </div>
      <span>Create a client</span>

      <div class="ui hidden divider"></div>

      <div class="ui error message"></div>

      {{template "input.clientname" . }}
      {{template "input.description" . }}

      <div class="field">
        <div class="ui left icon action input focus">
          <i class="world icon"></i>
          <input type="text" name="redirect_uri" placeholder="Redirect uri" />
          <button class="ui green icon button add">
            <i class="add icon"></i>
          </button>
        </div>
      </div>

      <div class="field">
        <div class="ui left icon action input focus">
          <i class="world icon"></i>
          <input type="text" name="post_logout_redirect_uri" placeholder="Post logout redirect uri" />
          <button class="ui green icon button add">
            <i class="add icon"></i>
          </button>
        </div>
      </div>

      <div class="field">
        <div class="ui selection dropdown">
          <input type="hidden" name="token_endpoint_auth_method">
          <i class="dropdown icon"></i>
          <div class="default text">Token endpoint auth method</div>
          <div class="menu">
            <div class="item" data-value="0">none</div>
            <div class="item" data-value="1">client_secret_post</div>
            <div class="item" data-value="2">client_secret_basic</div>
            <div class="item" data-value="3">private_key_jwt</div>
          </div>
        </div>
      </div>

      <div class="field">
        <div class="ui selection dropdown multiple">
          <input type="hidden" name="grant_type">
          <i class="dropdown icon"></i>
          <div class="default text">Grant type</div>
          <div class="menu">
            <div class="item" data-value="0">Authorization Code</div>
            <div class="item" data-value="1">Implicit</div>
            <div class="item" data-value="2">Password</div>
            <div class="item" data-value="3">Client Credientials</div>
            <div class="item" data-value="4">Device Code</div>
            <div class="item" data-value="5">Refresh Token</div>
          </div>
        </div>
      </div>

      <div class="field">
        <div class="ui selection dropdown multiple">
          <input type="hidden" name="response_type">
          <i class="dropdown icon"></i>
          <div class="default text">Response type</div>
          <div class="menu">
            <div class="item" data-value="0">Code</div>
            <div class="item" data-value="1">Token</div>
          </div>
        </div>
      </div>

      <div class="ui toggle checkbox">
        <input type="checkbox" name="is_public">
        <label><span data-tooltip="Client is for use in a system that is incapable of protecting a secret, hence it wont be generated">Client is public (Mobile App)</span></label>
      </div>

      <div class="ui hidden divider"></div>

      <button class="ui green button" type="submit"><i class="save icon"></i> Create Client</button>

    </form>

    </div>

  </div>

<script type="text/javascript">
  $(function(){
    $("input[name=token_endpoint_auth_method]").parent().dropdown()
    $("input[name=grant_type]").parent().dropdown()
    $("input[name=response_type]").parent().dropdown()
    $("input[name=redirect_uri]").parent().dropdown({
      allowAdditions: true,
      hideAdditions: false
    })
    $("input[name=post_logout_redirect_uri]").parent().dropdown()

    $("body").on("click", "input[name=redirect_uri] ~ .button, input[name=post_logout_redirect_uri] ~ .button", function(e){
      e.preventDefault();
      var field = $(this).closest(".field");
      if ( field.find(".button").hasClass("green") ) {
        clone(field);
      } else {
        remove(field);
      }
      return false;
    });

    function clone(field) {
      var newField = field.clone();
      newField.find("input").val("");
      newField.css("display", "none");
      field.after(newField);
      newField.slideDown();
      newField.find(".button").removeClass("green").addClass("red")
              .find("i").removeClass("add").addClass("remove");
    }

    function remove(field) {
      field.slideUp(function(){
        $(this).remove();
      });
    }

  });
</script>

{{ template "dashboardend" . }}
{{ template "htmlend" . }}
